<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>WinterChat - Ayarlar</title>
    <style>
        * { box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: #0F172A; color: white; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .box { background: #1E293B; padding: 40px; border-radius: 15px; width: 450px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); border: 1px solid #334155; }
        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #334155; padding-bottom: 15px; margin-bottom: 25px; }
        .title { color: #38BDF8; font-size: 20px; font-weight: bold; }
        label { display: block; color: #94A3B8; font-size: 13px; margin-bottom: 8px; font-weight: bold; }
        input { width: 100%; padding: 12px; margin-bottom: 20px; border-radius: 8px; border: 1px solid #475569; background: #0B0F19; color: white; outline: none; transition: 0.3s;}
        input:focus { border-color: #38BDF8; }
        input:disabled { opacity: 0.5; cursor: not-allowed; border-color: #334155; }
        
        .vip-lock { color: #F59E0B; font-size: 12px; float: right; }
        .vip-input { border: 1px solid #F59E0B !important; background: rgba(245, 158, 11, 0.05) !important; }
        
        button { width: 100%; padding: 14px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.2s; margin-bottom: 10px; }
        .btn-save { background: #22C55E; color: white; }
        .btn-save:hover { background: #16A34A; }
        .btn-back { background: #334155; color: white; }
        .btn-back:hover { background: #475569; }
    </style>
</head>
<body>
    <div class="box">
        <div class="header">
            <div class="title">‚öôÔ∏è Profil Ayarlarƒ±</div>
        </div>
        
        <label>Kullanƒ±cƒ± Adƒ±</label>
        <input type="text" id="user-display" disabled>
        
        <label>Yeni ≈ûifre Belirle</label>
        <input type="password" id="new-pass" placeholder="En az 4 karakter girin...">
        
        <div style="margin-top: 10px; padding-top: 20px; border-top: 1px dashed #334155;">
            <label>Profil Resmi (URL) <span class="vip-lock" id="vip-status-text">üîí Sadece VIP</span></label>
            <input type="text" id="avatar-url" placeholder="Resim veya GIF linki yapƒ±≈ütƒ±rƒ±n..." disabled>
            <div style="font-size: 11px; color: #64748B; margin-top: -15px; margin-bottom: 20px;">√ñrn: https://resim-linki.com/logo.png</div>
        </div>
        
        <button class="btn-save" onclick="ayarlariKaydet()">Ayarlarƒ± Kaydet</button>
        <button class="btn-back" onclick="window.location.href='index.html'">Ana Sayfaya D√∂n</button>
    </div>

    <script>
        const activeUser = localStorage.getItem('activeUser');
        if(!activeUser) window.location.href = 'login.html';

        let db = JSON.parse(localStorage.getItem('winterDB'));
        let acc = db[activeUser];
        let isVIP = acc.isVip || localStorage.getItem('isAdmin') === 'true';

        document.getElementById('user-display').value = activeUser;

        // Eƒüer VIP ise avatar kutusunun kilidini a√ß
        if(isVIP) {
            const avatarInput = document.getElementById('avatar-url');
            avatarInput.disabled = false;
            avatarInput.classList.add('vip-input');
            document.getElementById('vip-status-text').innerText = "üíé VIP Aktif";
            // Eskiden koyduƒüu bir resim varsa kutuya yazdƒ±r
            if(acc.avatar) avatarInput.value = acc.avatar;
        }

        function ayarlariKaydet() {
            const newPass = document.getElementById('new-pass').value.trim();
            const newAvatar = document.getElementById('avatar-url').value.trim();

            if(newPass && newPass.length < 4) return alert("≈ûifre √ßok kƒ±sa! En az 4 karakter kullanƒ±n.");

            if(newPass) db[activeUser].password = newPass;
            
            // Eƒüer VIP ise ve link girdiyse veritabanƒ±na kaydet
            if(isVIP) {
                db[activeUser].avatar = newAvatar;
            }

            localStorage.setItem('winterDB', JSON.stringify(db));
            alert("‚úÖ Profil ayarlarƒ±nƒ±z ba≈üarƒ±yla g√ºncellendi!");
            window.location.reload();
        }
    </script>
</body>
</html>
